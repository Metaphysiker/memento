<%= simple_form_for :search_inputs, {url: search_basic_form_path, method: :get, remote: true} do |f| %>
  <%= f.text_field :"search_#{records.klass.to_s.pluralize.downcase}", placeholder: "Nach #{records.klass.model_name.human(count: 2)} suchen", autocomplete: :off, class: "form-control" %>
  <br>
  <%= f.input :tags, as: :select, collection: TagList.all, label_method: :name, value_method: :name, input_html: {class: 'chosen-select', multiple: true} %>
  <br>
  <%= f.input :institutions, as: :select, collection: Institution.all, label_method: :name, value_method: :id, input_html: {class: 'chosen-select', multiple: true} %>
  <%= f.hidden_field :model, value: records.klass.to_s %>
  <%= f.submit "Suchen", id: "trigger_main_search", class: "btn btn-primary" %>
<% end %>

<script>
    $(document).ready(function(){
      var records = <%= raw records.klass.to_s.pluralize.downcase.inspect %>;
      var records_div = "." + records;
      var search_records = "#search_" + records;
      var trigger_records = "#trigger_" + records;

        $( search_records ).keyup(function() {
          if ($( search_records ).val().length > 3){
            if ($( records_div ).html() != "<div class=\"mx-auto loader\"></div>"){
              $( records_div ).html( "<div class=\"mx-auto loader\"></div>" );
            }
            $(trigger_records).click();
          }
        });
    });
</script>
